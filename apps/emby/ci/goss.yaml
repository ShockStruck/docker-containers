---
# Process validation for EmbyServer (minimal)
process:
  EmbyServer:
    running: true

# Command to verify the process user and executable
command:
  check-emby-process:
    exec: "ps -u nobody -o comm | grep -q EmbyServer && [ -x /app/emby/EmbyServer ]"
    exit-status: 0
    timeout: 5000

# Port validation
port:
  tcp:8096:
    listening: true
    ip:
      - 0.0.0.0

# HTTP endpoint validation
http:
  http://localhost:8096/web:
    status: 200
    timeout: 5000
    headers:
      - "Server: Emby"

# File validation for critical paths
file:
  /app/emby/EmbyServer:
    exists: true
    mode: "0755"
    owner: root
    group: root
  /config:
    exists: true
    mode: "0755"
    owner: nobody
    group: nogroup
    filetype: directory

# Environment variable validation
env:
  LD_LIBRARY_PATH:
    matches: "/app/emby.*"
  FONTCONFIG_PATH:
    equals: "/app/emby/etc/fonts"
  SSL_CERT_FILE:
    equals: "/app/emby/etc/ssl/certs/ca-certificates.crt"